<script src="/mathjax_config.js"></script>
<script
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
></script>
<a href="/problem_872.html">Next</a> <a href="/problem_870.html">Previous</a>
<h1>Problem 871</h1>
<p>
    Let $f$ be a function from a finite set $S$ to itself. A
    <dfn>drifting subset</dfn> for $f$ is a subset $A$ of $S$ such that the
    number of elements in the union $A \cup f(A)$ is equal to twice the number
    of elements of $A$.<br />
    We write $D(f)$ for the maximal number of elements among all drifting
    subsets for $f$.
</p>

<p>
    For a positive integer $n$, define $f_n$ as the function from $\{0, 1,
    \dots, n - 1\}$ to itself sending $x$ to $x^3 + x + 1 \bmod n$.<br />
    You are given $D(f_5) = 1$ and $D(f_{10}) = 3$.
</p>

<p>Find $\displaystyle\sum_{i = 1}^{100} D(f_{10^5 + i})$.</p>
