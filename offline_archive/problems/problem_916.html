<script src="/mathjax_config.js"></script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><a href="/problem_917.html">Next</a> <a href="/problem_915.html">Previous</a><h1>Problem 916</h1><p>Let $P(n)$ be the number of permutations of $\{1,2,3,\ldots,2n\}$ such that:
<br>
1. There is no ascending subsequence with more than $n+1$ elements, and
<br>
2. There is no descending subsequence with more than two elements.
</p>

<p>Note that subsequences need not be contiguous. For example, the permutation $(4,1,3,2)$ is not counted because it has a descending subsequence of three elements: $(4,3,2)$. You are given $P(2)=13$ and $P(10) \equiv 45265702 \pmod{10^9 + 7}$.</p>

<p>Find $P(10^8)$ and give your answer modulo $10^9 + 7$.</p>

