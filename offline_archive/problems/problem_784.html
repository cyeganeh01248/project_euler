<script src="/mathjax_config.js"></script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><a href="/problem_785.html">Next</a> <a href="/problem_783.html">Previous</a><h1>Problem 784</h1><p>
Let's call a pair of positive integers $p$, $q$ ($p \lt q$) <dfn>reciprocal</dfn>, if there is a positive integer $r\lt p$ such that $r$ equals both the inverse of $p$ modulo $q$ and the inverse of $q$ modulo $p$.</p>

<p>
For example, $(3,5)$ is one reciprocal pair for $r=2$.<br>
Let $F(N)$ be the total sum of $p+q$ for all reciprocal pairs $(p,q)$ where $p \le N$.</p>

<p>
$F(5)=59$ due to these four reciprocal pairs $(3,5)$, $(4,11)$, $(5,7)$ and $(5,19)$.<br>
You are also given $F(10^2) = 697317$.</p>

<p>
Find $F(2\cdot 10^6)$.</p>
